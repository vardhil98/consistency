<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Habit Tracker</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    display: flex;
    justify-content: center;
    padding: 20px;
}
.calendar-container {
    background-color: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    max-width: 400px;
    width: 100%;
}
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}
.header h2 {
    font-size: 22px;
    margin: 0;
}
.nav-buttons button {
    font-size: 16px;
    padding: 6px 12px;
    border-radius: 8px;
    border: none;
    background-color: #2196F3;
    color: white;
    cursor: pointer;
    margin: 0 2px;
    transition: 0.2s;
}
.nav-buttons button:hover {
    background-color: #1976D2;
}
.calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 6px;
}
.day-name, .calendar-day {
    text-align: center;
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
}
.day-name {
    font-weight: bold;
    background-color: #e0e0e0;
}
.calendar-day {
    background-color: #f0f8ff;
    cursor: pointer;
    transition: 0.2s;
}
.calendar-day:hover {
    background-color: #b3e5fc;
}
.calendar-day.selected {
    background-color: #4caf50;
    color: white;
    font-weight: bold;
}
.buttons {
    margin-top: 15px;
    display: flex;
    justify-content: center;
}
.buttons button {
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: 0.2s;
}
.break-btn {
    background-color: #f44336;
    color: white;
}
.break-btn:hover {
    background-color: #d32f2f;
}
.reward-container {
    margin-top: 15px;
    background-color: #ffeb3b;
    padding: 10px;
    border-radius: 8px;
    text-align: center;
    display: none; /* Hidden by default */
}
.reward-container button {
    margin-top: 8px;
    padding: 8px 12px;
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.2s;
}
.reward-container button:hover {
    background-color: #388e3c;
}
@media (max-width: 600px) {
    .header h2 { font-size: 20px; }
    .day-name, .calendar-day { font-size: 18px; padding: 12px; }
    .nav-buttons button, .buttons button { font-size: 18px; padding: 12px 16px; }
}
</style>
</head>
<body>
<div class="calendar-container">
    <div class="header">
        <div class="nav-buttons">
            <button id="prevYear">&laquo;</button>
            <button id="prevMonth">&lsaquo;</button>
        </div>
        <h2 id="monthYear"></h2>
        <div class="nav-buttons">
            <button id="nextMonth">&rsaquo;</button>
            <button id="nextYear">&raquo;</button>
        </div>
    </div>
    <div class="calendar" id="calendar"></div>
    <div class="buttons">
        <button class="break-btn" id="breakBtn">Break Consistency</button>
    </div>
    <div class="reward-container" id="rewardContainer">
        ðŸŽ‰ You earned a reward! ðŸŽ‰<br>
        <button id="useRewardBtn">Use Reward</button>
    </div>
</div>

<script>
const calendarEl = document.getElementById('calendar');
const monthYearEl = document.getElementById('monthYear');
const prevMonthBtn = document.getElementById('prevMonth');
const nextMonthBtn = document.getElementById('nextMonth');
const prevYearBtn = document.getElementById('prevYear');
const nextYearBtn = document.getElementById('nextYear');
const breakBtn = document.getElementById('breakBtn');
const rewardContainer = document.getElementById('rewardContainer');
const useRewardBtn = document.getElementById('useRewardBtn');

let selectedDates = JSON.parse(localStorage.getItem('selectedDates')) || [];
let rewardEarned = JSON.parse(localStorage.getItem('rewardEarned')) || false;
let today = new Date();
let currentMonth = today.getMonth();
let currentYear = today.getFullYear();
const dayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

function getSortedDates(){
    return selectedDates.map(d => new Date(d)).sort((a,b)=>a-b);
}

// Check for any streak of 10 consecutive days
function checkReward() {
    const sortedDates = getSortedDates();
    let streak = 1;
    let earned = rewardEarned || false;

    for(let i=1;i<sortedDates.length;i++){
        const diff = (sortedDates[i]-sortedDates[i-1])/(1000*60*60*24);
        if(diff === 1){
            streak++;
            if(streak >= 10 && !earned){
                earned = true;
                rewardEarned = true;
                localStorage.setItem('rewardEarned', JSON.stringify(true));
            }
        } else {
            streak = 1; // streak broken
        }
    }

    // If no streak >=10, remove reward
    if(!sortedDates.some((_,i)=> {
        if(i===0) return false;
        return (sortedDates[i]-sortedDates[i-1])/(1000*60*60*24)===1;
    }) || sortedDates.length < 10){
        earned = false;
        rewardEarned = false;
        localStorage.setItem('rewardEarned', JSON.stringify(false));
    }

    rewardContainer.style.display = earned ? 'block' : 'none';
}

function renderCalendar(month, year) {
    calendarEl.innerHTML = '';
    monthYearEl.textContent = `${new Date(year, month).toLocaleString('default', { month: 'long' })} ${year}`;
    dayNames.forEach(d => {
        const dayNameEl = document.createElement('div');
        dayNameEl.classList.add('day-name');
        dayNameEl.textContent = d;
        calendarEl.appendChild(dayNameEl);
    });

    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month+1, 0).getDate();
    for(let i=0;i<firstDay;i++){
        calendarEl.appendChild(document.createElement('div'));
    }

    for(let day=1; day<=daysInMonth; day++){
        const dateStr = `${year}-${month+1}-${day}`;
        const dayEl = document.createElement('div');
        dayEl.classList.add('calendar-day');
        dayEl.textContent = day;

        const dateObj = new Date(year, month, day);
        if(dateObj > new Date()){
            dayEl.style.backgroundColor = '#e0e0e0';
            dayEl.style.color = '#888';
            dayEl.style.cursor = 'not-allowed';
        } else {
            if(selectedDates.includes(dateStr)){
                dayEl.classList.add('selected');
            }
            dayEl.addEventListener('click', ()=>{
                if(selectedDates.includes(dateStr)){
                    selectedDates = selectedDates.filter(d=>d!==dateStr);
                    dayEl.classList.remove('selected');
                } else {
                    selectedDates.push(dateStr);
                    dayEl.classList.add('selected');
                }
                localStorage.setItem('selectedDates', JSON.stringify(selectedDates));
                checkReward();
            });
        }
        calendarEl.appendChild(dayEl);
    }
}

prevMonthBtn.addEventListener('click', ()=>{
    currentMonth--;
    if(currentMonth<0){ currentMonth=11; currentYear--; }
    renderCalendar(currentMonth, currentYear);
});
nextMonthBtn.addEventListener('click', ()=>{
    currentMonth++;
    if(currentMonth>11){ currentMonth=0; currentYear++; }
    renderCalendar(currentMonth, currentYear);
});
prevYearBtn.addEventListener('click', ()=>{
    currentYear--;
    renderCalendar(currentMonth, currentYear);
});
nextYearBtn.addEventListener('click', ()=>{
    currentYear++;
    renderCalendar(currentMonth, currentYear);
});

breakBtn.addEventListener('click', ()=>{
    selectedDates = [];
    localStorage.removeItem('selectedDates');
    rewardEarned = false;
    localStorage.setItem('rewardEarned', JSON.stringify(false));
    renderCalendar(currentMonth, currentYear);
    checkReward();
});

useRewardBtn.addEventListener('click', ()=>{
    rewardEarned = false;
    localStorage.setItem('rewardEarned', JSON.stringify(false));
    rewardContainer.style.display = 'none';
});

renderCalendar(currentMonth, currentYear);
checkReward();
</script>
</body>
</html>
