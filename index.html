<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Consistency Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 20px;
      background: #f9f9f9;
    }
    h1 { color: #333; }
    #calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
    }
    .day, .empty {
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      cursor: pointer;
      background: #fff;
      transition: 0.2s;
    }
    .day:hover { background: #f0f0f0; }
    .selected { background: #4caf50; color: white; }
    .disabled { background: #eee; color: #999; cursor: not-allowed; }
    .empty { background: transparent; border: none; cursor: default; }
    #monthYear {
      font-size: 20px;
      margin: 10px 0;
    }
    .rewards {
      margin-top: 20px;
      text-align: left;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      background: #fff;
      padding: 15px;
      border-radius: 6px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .reward-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }
    .reward-item:last-child { border-bottom: none; }
    button {
      background: #ff4d4d;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }
    button:hover { background: #e60000; }
    .break-btn {
      margin-top: 20px;
      background: #444;
    }
    .break-btn:hover { background: #000; }
  </style>
</head>
<body>
  <h1>Consistency Tracker</h1>
  <h2 id="monthYear"></h2>
  <div id="calendar"></div>

  <div class="rewards">
    <h3>Unlocked Rewards üéÅ</h3>
    <div id="rewardList"></div>
  </div>

  <button class="break-btn" onclick="breakConsistency()">Break Consistency</button>

  <script>
    const monthYearEl = document.getElementById("monthYear");
    const calendarEl = document.getElementById("calendar");
    const rewardListEl = document.getElementById("rewardList");

    const monthNames = [
      "January","February","March","April","May","June",
      "July","August","September","October","November","December"
    ];

    let today = new Date();
    let month = today.getMonth();
    let year = today.getFullYear();

    let selectedDays = JSON.parse(localStorage.getItem("selectedDays")) || [];
    let rewards = JSON.parse(localStorage.getItem("rewards")) || [];

    const rewardPool = ["Starbucks Drink ‚òï", "Real Fruit Juice ü•§", "Booster Juice üçπ"];

    function renderCalendar() {
      calendarEl.innerHTML = "";
      monthYearEl.textContent = `${monthNames[month]} ${year}`;

      let firstDay = new Date(year, month, 1).getDay();
      let daysInMonth = new Date(year, month + 1, 0).getDate();

      const weekdays = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
      weekdays.forEach(d => {
        let el = document.createElement("div");
        el.textContent = d;
        el.style.fontWeight = "bold";
        calendarEl.appendChild(el);
      });

      for (let i = 0; i < firstDay; i++) {
        let empty = document.createElement("div");
        empty.classList.add("empty");
        calendarEl.appendChild(empty);
      }

      for (let day = 1; day <= daysInMonth; day++) {
        let cell = document.createElement("div");
        cell.classList.add("day");
        cell.textContent = day;

        let key = `${year}-${month+1}-${day}`;
        let cellDate = new Date(year, month, day);

        // Disable future dates
        if (cellDate > today) {
          cell.classList.add("disabled");
        }

        // Already selected
        if (selectedDays.includes(key)) {
          cell.classList.add("selected");
        }

        if (!cell.classList.contains("disabled")) {
          cell.addEventListener("click", () => toggleDay(key, cell));
        }

        calendarEl.appendChild(cell);
      }
    }

    function toggleDay(key, cell) {
      if (selectedDays.includes(key)) {
        // Unselect if already selected
        selectedDays = selectedDays.filter(d => d !== key);
        cell.classList.remove("selected");
      } else {
        // Select new day
        selectedDays.push(key);
        cell.classList.add("selected");
      }

      // Rewards check
      let consistencyCount = selectedDays.length;
      if (consistencyCount > 0 && consistencyCount % 10 === 0) {
        let reward = rewardPool[(consistencyCount/10 - 1) % rewardPool.length];
        if (!rewards.includes(reward)) {
          rewards.push(reward);
          alert(`üéâ Congrats! You earned: ${reward}`);
        }
      }

      saveData();
      renderRewards();
    }

    function renderRewards() {
      rewardListEl.innerHTML = "";
      rewards.forEach((r, idx) => {
        let div = document.createElement("div");
        div.classList.add("reward-item");
        div.innerHTML = `<span>${r}</span>
          <button onclick="useReward(${idx})">Use</button>`;
        rewardListEl.appendChild(div);
      });
    }

    function useReward(index) {
      rewards.splice(index, 1);
      saveData();
      renderRewards();
    }

    function breakConsistency() {
      selectedDays = [];
      rewards = [];
      localStorage.clear();
      alert("Consistency manually broken ‚ùå. Starting over!");
      renderCalendar();
      renderRewards();
    }

    function saveData() {
      localStorage.setItem("selectedDays", JSON.stringify(selectedDays));
      localStorage.setItem("rewards", JSON.stringify(rewards));
    }

    renderCalendar();
    renderRewards();
  </script>
</body>
</html>
